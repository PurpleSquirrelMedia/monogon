#!/usr/bin/env bash
set -euo pipefail

if ! podman inspect monogon-dev --format ":{{ range .Mounts }}{{.Source }}:{{ end }}" | grep -q ":$(pwd):"; then
    echo "Please run this wrapper from the original checkout"
    exit 1
fi

exec podman exec -it monogon-dev bazel --output_user_root ${HOME}/.cache/bazel-monogon "$@"
